<!DOCTYPE html>
<html lang="zh-CN">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
	<title>è½¯ä»¶æœç´¢ä¸‹è½½</title>
	<style>
		* {
			margin: 0;
			padding: 0;
			box-sizing: border-box;
		}

		body {
			font-family: Arial, sans-serif;
			background-color: #f5f5f5;
			padding: 0;
			touch-action: pan-x pan-y;
			overflow-x: hidden;
			padding-bottom: 60px;
		}

		/* é˜²æ­¢é¡µé¢ç¼©æ”¾ */
		html {
			touch-action: manipulation;
			-webkit-text-size-adjust: none;
			-ms-text-size-adjust: none;
			text-size-adjust: none;
		}

		/* ç”¨æˆ·ä¿¡æ¯æ  */
		.user-info-bar {
			background-color: #45a049;
			height: 40px;
			display: flex;
			align-items: center;
			justify-content: space-between;
			padding: 0 15px;
			color: white;
			font-size: 14px;
		}

		.welcome-text {
			font-weight: bold;
		}

		.login-btn, .logout-btn {
			background-color: rgba(255,255,255,0.2);
			color: white;
			border: 1px solid rgba(255,255,255,0.3);
			border-radius: 15px;
			padding: 5px 12px;
			cursor: pointer;
			font-size: 12px;
		}

		.login-btn:hover, .logout-btn:hover {
			background-color: rgba(255,255,255,0.3);
		}

		/* ç™»å½•å¼¹çª— */
		.modal-overlay {
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			background-color: rgba(0, 0, 0, 0.5);
			z-index: 1000;
			display: none;
			justify-content: center;
			align-items: center;
		}

		.modal-overlay.show {
			display: flex;
		}

		.login-modal {
			background-color: white;
			border-radius: 10px;
			padding: 30px;
			width: 90%;
			max-width: 400px;
			box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
		}

		.modal-header h2 {
			color: #333;
			font-size: 20px;
			margin-bottom: 15px;
			text-align: center;
		}

		.form-group {
			margin-bottom: 20px;
		}

		.form-group label {
			display: block;
			margin-bottom: 8px;
			color: #333;
			font-weight: bold;
		}

		.form-input {
			width: 100%;
			padding: 12px;
			border: 2px solid #ddd;
			border-radius: 8px;
			font-size: 16px;
		}

		.form-input:focus {
			outline: none;
			border-color: #4CAF50;
		}

		.error-message {
			color: #f44336;
			font-size: 12px;
			margin-top: 5px;
			display: none;
		}

		.modal-buttons {
			display: flex;
			gap: 10px;
			justify-content: flex-end;
		}

		.btn {
			padding: 10px 20px;
			border: none;
			border-radius: 8px;
			cursor: pointer;
			font-size: 14px;
			font-weight: bold;
		}

		.btn-primary {
			background-color: #4CAF50;
			color: white;
		}

		.btn-secondary {
			background-color: #f5f5f5;
			color: #666;
		}

		/* åº•éƒ¨å¯¼èˆªæ  */
		.bottom-nav {
			position: fixed;
			bottom: 0;
			left: 0;
			width: 100%;
			height: 60px;
			background-color: #fff;
			border-top: 1px solid #e5e5e5;
			display: flex;
			justify-content: space-around;
			align-items: center;
			z-index: 200;
		}

		.nav-item {
			display: flex;
			flex-direction: column;
			align-items: center;
			justify-content: center;
			flex: 1;
			height: 100%;
			text-decoration: none;
			color: #999;
			transition: color 0.3s;
		}

		.nav-item.active {
			color: #4CAF50;
		}

		.nav-icon {
			width: 24px;
			height: 24px;
			margin-bottom: 4px;
			font-size: 20px;
		}

		.nav-icon img {
			width: 100%;
			height: 100%;
			object-fit: contain;
		}

		.nav-text {
			font-size: 12px;
		}

		/* åŠŸèƒ½åˆ—è¡¨æ ·å¼ */
		.function-list {
			background-color: white;
			margin: 20px;
			border-radius: 10px;
			box-shadow: 0 2px 10px rgba(0,0,0,0.1);
			overflow: hidden;
			transition: all 0.3s ease;
		}

		.list-item {
			display: flex;
			align-items: center;
			justify-content: space-between;
			padding: 15px 20px;
			border-bottom: 1px solid #f0f0f0;
			cursor: pointer;
			transition: background-color 0.3s;
		}

		.list-item:last-child {
			border-bottom: none;
		}

		.list-item:hover {
			background-color: #f9f9f9;
		}

		.list-item-left {
			display: flex;
			align-items: center;
		}

		.list-icon {
			width: 20px;
			height: 20px;
			margin-right: 12px;
			font-size: 16px;
		}

		.list-text {
			font-size: 16px;
			color: #333;
		}

		.view-btn {
			background-color: #2196F3;
			color: white;
			border: none;
			border-radius: 6px;
			padding: 6px 12px;
			font-size: 12px;
			cursor: pointer;
			transition: background-color 0.3s;
		}

		.view-btn:hover {
			background-color: #1976D2;
		}

		/* è”ç³»ä½œè€…å¼¹çª— */
		.contact-modal {
			background-color: white;
			border-radius: 10px;
			padding: 30px;
			width: 90%;
			max-width: 350px;
			box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
			text-align: center;
		}

		.contact-title {
			color: #333;
			font-size: 18px;
			margin-bottom: 20px;
		}

		.qq-info {
			display: flex;
			align-items: center;
			justify-content: center;
			gap: 10px;
			margin-bottom: 20px;
			padding: 15px;
			background-color: #f5f5f5;
			border-radius: 8px;
		}

		.qq-number {
			font-size: 18px;
			font-weight: bold;
			color: #333;
		}

		.contact-buttons {
			display: flex;
			gap: 10px;
			justify-content: center;
		}

		/* å…³äºæˆ‘ä»¬é¡µé¢æ ·å¼ */
		.about-page {
			background-color: #f5f5f5;
			min-height: 100vh;
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			padding: 80px 20px 20px;
			z-index: 500;
			display: none;
		}

		.about-header {
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			background-color: #fff;
			border-bottom: 1px solid #e5e5e5;
			padding: 15px 20px;
			display: flex;
			align-items: center;
			justify-content: space-between;
			z-index: 600;
		}

		.back-btn {
			background: none;
			border: none;
			font-size: 18px;
			cursor: pointer;
			padding: 5px 10px;
			border-radius: 5px;
		}

		.back-btn:hover {
			background-color: #f0f0f0;
		}

		.header-title {
			font-size: 16px;
			font-weight: bold;
			color: #333;
		}

		.app-info {
			text-align: center;
			margin-top: 20px;
		}

		.app-icon {
			width: 80px;
			height: 80px;
			background-color: #4CAF50;
			border-radius: 15px;
			margin: 0 auto 10px;
			display: flex;
			align-items: center;
			justify-content: center;
			font-size: 36px;
			color: white;
		}

		.app-icon img {
			width: 100%;
			height: 100%;
			object-fit: cover;
			border-radius: 15px;
		}

		.app-name {
			font-size: 18px;
			font-weight: bold;
			color: #333;
			margin-bottom: 5px;
		}

		.version-display {
			font-size: 14px;
			color: #666;
		}

		/* è®¾ç½®é¡µé¢æ ·å¼ - ä¿®æ”¹åçš„ç®€æ´ç‰ˆæœ¬ */
		.settings-page {
			background-color: #f5f5f5;
			min-height: 100vh;
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			padding: 80px 20px 20px;
			z-index: 500;
			display: none;
		}

		.settings-header {
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			background-color: #fff;
			border-bottom: 1px solid #e5e5e5;
			padding: 15px 20px;
			display: flex;
			align-items: center;
			justify-content: space-between;
			z-index: 600;
		}

		/* æ–°å¢ï¼šé¡¶éƒ¨å›¾æ ‡åŒºåŸŸ */
		.settings-icon-container {
			margin: 20px auto;
			width: 80px;
			height: 80px;
			border-radius: 18px;
			overflow: hidden;
			box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
			background-color: white;
		}

		.settings-icon {
			width: 100%;
			height: 100%;
			object-fit: cover;
		}

		/* ä¿®æ”¹åçš„è®¾ç½®å†…å®¹åŒºåŸŸ */
		.settings-content {
			background-color: white;
			border-radius: 10px;
			padding: 20px;
			margin-top: 20px;
			box-shadow: 0 2px 10px rgba(0,0,0,0.1);
		}

		.setting-item {
			padding: 15px 0;
			border-bottom: 1px solid #f0f0f0;
			display: flex;
			justify-content: space-between;
			align-items: center;
		}

		.setting-item:last-child {
			border-bottom: none;
		}

		.setting-label {
			font-size: 16px;
			color: #333;
		}

		.setting-value {
			font-size: 14px;
			color: #666;
			display: flex;
			align-items: center;
			gap: 8px;
		}

		/* å¤šè¯­è¨€å¼€å…³æ ·å¼ */
		.language-switch {
			position: relative;
			display: inline-block;
			width: 50px;
			height: 24px;
		}

		.language-switch input {
			opacity: 0;
			width: 0;
			height: 0;
		}

		.slider {
			position: absolute;
			cursor: pointer;
			top: 0;
			left: 0;
			right: 0;
			bottom: 0;
			background-color: #ccc;
			transition: .4s;
			border-radius: 24px;
		}

		.slider:before {
			position: absolute;
			content: "";
			height: 18px;
			width: 18px;
			left: 3px;
			bottom: 3px;
			background-color: white;
			transition: .4s;
			border-radius: 50%;
		}

		input:checked + .slider {
			background-color: #4CAF50;
		}

		input:checked + .slider:before {
			transform: translateX(26px);
		}

		/* betaæ ‡è¯†æ ·å¼ */
		.beta-tag {
			background-color: #e0e0e0;
			color: #666;
			font-size: 10px;
			padding: 2px 6px;
			border-radius: 3px;
			margin-left: 5px;
		}

		/* å¾®ä¿¡é£æ ¼é€šçŸ¥å¼¹çª— */
		.wechat-notification {
			position: fixed;
			top: -200px;
			left: 50%;
			transform: translateX(-50%);
			width: 90%;
			max-width: 320px;
			background: linear-gradient(135deg, #07bb07, #00d100);
			border-radius: 8px;
			padding: 15px;
			box-shadow: 0 4px 20px rgba(0,0,0,0.3);
			z-index: 2000;
			transition: top 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
			color: white;
			cursor: pointer;
		}

		.wechat-notification.show {
			top: 20px;
		}

		.wechat-notification:active {
			top: -200px !important;
		}

		.notification-header {
			display: flex;
			align-items: center;
			margin-bottom: 8px;
		}

		.studio-name {
			font-size: 16px;
			font-weight: bold;
			margin-left: 8px;
		}

		.notification-content {
			font-size: 13px;
			opacity: 0.9;
			line-height: 1.4;
		}

		.notification-icon {
			width: 20px;
			height: 20px;
			background-color: rgba(255,255,255,0.2);
			border-radius: 50%;
			display: flex;
			align-items: center;
			justify-content: center;
			font-size: 12px;
		}

		/* å¤åˆ¶æˆåŠŸæç¤ºå¼¹çª— */
		.copy-success-modal {
			position: fixed;
			top: 50%;
			left: 50%;
			transform: translate(-50%, -50%);
			background-color: rgba(0, 0, 0, 0.8);
			color: white;
			padding: 15px 25px;
			border-radius: 8px;
			z-index: 1500;
			display: none;
			font-size: 16px;
		}

		.copy-success-modal.show {
			display: block;
			animation: fadeInOut 2s ease-in-out;
		}

		@keyframes fadeInOut {
			0% { opacity: 0; }
			20% { opacity: 1; }
			80% { opacity: 1; }
			100% { opacity: 0; }
		}

		/* éœ¸ç‹æ¡æ¬¾å¼¹çª—æ ·å¼ */
		.terms-overlay {
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			background-color: rgba(0, 0, 0, 0.6);
			z-index: 3000;
			display: none;
			justify-content: center;
			align-items: center;
			backdrop-filter: blur(5px);
			-webkit-backdrop-filter: blur(5px);
		}

		.terms-overlay.show {
			display: flex;
		}

		.terms-modal {
			background-color: white;
			border-radius: 15px;
			width: 90%;
			max-width: 600px;
			max-height: 80vh;
			position: relative;
			box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
			display: flex;
			flex-direction: column;
		}

		.terms-header {
			padding: 20px;
			border-bottom: 1px solid #eee;
			display: flex;
			justify-content: space-between;
			align-items: center;
			background-color: #f8f9fa;
			border-radius: 15px 15px 0 0;
		}

		.terms-title {
			font-size: 18px;
			font-weight: bold;
			color: #333;
			margin: 0;
		}

		.terms-close {
			background: none;
			border: none;
			font-size: 24px;
			color: #999;
			cursor: pointer;
			width: 30px;
			height: 30px;
			display: flex;
			align-items: center;
			justify-content: center;
			border-radius: 50%;
			transition: all 0.3s;
		}

		.terms-close:hover {
			background-color: #f0f0f0;
			color: #333;
		}

		.terms-content {
			padding: 20px;
			overflow-y: auto;
			flex: 1;
			line-height: 1.6;
			color: #555;
			font-size: 14px;
		}

		.loading-text {
			text-align: center;
			color: #999;
			font-style: italic;
			padding: 40px;
		}

		.error-text {
			text-align: center;
			color: #f44336;
			font-style: italic;
			padding: 40px;
		}

		/* å®‰å…¨å¯¼èˆªæŒ‡ç¤ºå™¨ */
		.nav-safe-indicator {
			position: fixed;
			top: 50px;
			right: 10px;
			background: rgba(76, 175, 80, 0.9);
			color: white;
			padding: 5px 10px;
			border-radius: 15px;
			font-size: 12px;
			z-index: 1000;
			display: none;
			animation: pulse 2s infinite;
		}

		@keyframes pulse {
			0% { opacity: 0.7; }
			50% { opacity: 1; }
			100% { opacity: 0.7; }
		}

		/* åŠ è½½æŒ‡ç¤ºå™¨ - ä¿ç•™ä½†ä¸ä½¿ç”¨ */
		.loading-overlay {
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			background: rgba(0, 0, 0, 0.5);
			z-index: 9999;
			display: none;
			justify-content: center;
			align-items: center;
		}

		.loading-spinner {
			width: 50px;
			height: 50px;
			border: 5px solid #f3f3f3;
			border-top: 5px solid #4CAF50;
			border-radius: 50%;
			animation: spin 1s linear infinite;
		}

		@keyframes spin {
			0% { transform: rotate(0deg); }
			100% { transform: rotate(360deg); }
		}

		/* é“¾æ¥å¼¹çª—æ ·å¼ */
		.link-modal {
			background-color: white;
			border-radius: 10px;
			padding: 20px;
			width: 90%;
			max-width: 400px;
			box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
		}

		.link-modal-header {
			display: flex;
			justify-content: space-between;
			align-items: center;
			margin-bottom: 15px;
			padding-bottom: 10px;
			border-bottom: 1px solid #eee;
		}

		.link-modal-title {
			font-size: 18px;
			font-weight: bold;
			color: #333;
		}

		.link-modal-close {
			background: none;
			border: none;
			font-size: 20px;
			color: #999;
			cursor: pointer;
		}

		.link-content {
			margin: 15px 0;
		}

		.link-url {
			width: 100%;
			padding: 10px;
			border: 1px solid #ddd;
			border-radius: 6px;
			font-size: 14px;
			word-break: break-all;
			margin-bottom: 10px;
		}
	</style>
</head>
<body>
	<!-- å®‰å…¨å¯¼èˆªæŒ‡ç¤ºå™¨ -->
	<div id="navSafeIndicator" class="nav-safe-indicator">å®‰å…¨å¯¼èˆªå·²å¯ç”¨</div>

	<!-- åŠ è½½æŒ‡ç¤ºå™¨ - ä¿ç•™ä½†ä¸ä½¿ç”¨ -->
	<div id="loadingOverlay" class="loading-overlay">
		<div class="loading-spinner"></div>
	</div>

	<!-- ç”¨æˆ·ä¿¡æ¯æ  -->
	<div class="user-info-bar">
		<div class="welcome-text" id="welcomeText">æ¬¢è¿è®¿é—®</div>
		<div>
			<span id="loginStatus" class="login-btn" onclick="showLoginModal()">ç‚¹å‡»ç™»å½•</span>
			<span id="logoutBtn" class="logout-btn" onclick="logout()" style="display: none; margin-left: 10px;">é€€å‡º</span>
		</div>
	</div>

	<!-- åŠŸèƒ½åˆ—è¡¨å®¹å™¨ -->
	<div id="functionListContainer" class="function-list">
		<!-- åŠŸèƒ½åˆ—è¡¨å°†é€šè¿‡é…ç½®åŠ¨æ€ç”Ÿæˆ -->
	</div>

	<!-- ç™»å½•å¼¹çª— -->
	<div id="loginModal" class="modal-overlay" onclick="closeLoginModal(event)">
		<div class="login-modal" onclick="event.stopPropagation()">
			<div class="modal-header">
				<h2 data-zh="ç”¨æˆ·ç™»å½•" data-en="User Login">ç”¨æˆ·ç™»å½•</h2>
			</div>
			
			<form id="loginForm">
				<div class="form-group">
					<label for="username" data-zh="è´¦å·ï¼š" data-en="Username:">è´¦å·ï¼š</label>
					<input type="text" id="username" class="form-input" placeholder="è‡³å°‘2ä½å­—ç¬¦" data-placeholder-zh="è‡³å°‘2ä½å­—ç¬¦" data-placeholder-en="At least 2 characters">
					<div id="usernameError" class="error-message" data-zh="è´¦å·è‡³å°‘éœ€è¦2ä½å­—ç¬¦" data-en="Username needs at least 2 characters">è´¦å·è‡³å°‘éœ€è¦2ä½å­—ç¬¦</div>
				</div>
				
				<div class="form-group">
					<label for="password" data-zh="å¯†ç ï¼š" data-en="Password:">å¯†ç ï¼š</label>
					<input type="password" id="password" class="form-input" placeholder="8-12ä½ï¼Œéœ€å«è‹±æ–‡å’Œæ•°å­—" data-placeholder-zh="8-12ä½ï¼Œéœ€å«è‹±æ–‡å’Œæ•°å­—" data-placeholder-en="8-12 characters, must include letters and numbers">
					<div id="passwordError" class="error-message" data-zh="å¯†ç éœ€8-12ä½ï¼Œä¸”å¿…é¡»åŒ…å«è‹±æ–‡å’Œæ•°å­—" data-en="Password must be 8-12 characters and include both letters and numbers">å¯†ç éœ€8-12ä½ï¼Œä¸”å¿…é¡»åŒ…å«è‹±æ–‡å’Œæ•°å­—</div>
				</div>
				
				<div class="modal-buttons">
					<button type="button" class="btn btn-secondary" onclick="closeLoginModal()">å–æ¶ˆ</button>
					<button type="submit" class="btn btn-primary" data-zh="ç¡®å®š" data-en="Confirm">ç¡®å®š</button>
				</div>
			</form>
		</div>
	</div>

	<!-- è”ç³»ä½œè€…å¼¹çª— -->
	<div id="contactModal" class="modal-overlay" onclick="closeContactModal(event)">
		<div class="contact-modal" onclick="event.stopPropagation()">
			<h2 class="contact-title" data-zh="è”ç³»ä½œè€…" data-en="Contact Author">è”ç³»ä½œè€…</h2>
			<div class="qq-info">
				<span data-zh="ä½œè€…QQï¼š" data-en="Author QQ:">ä½œè€…QQï¼š</span>
				<span class="qq-number" id="qqDisplay">2019947085</span>
			</div>
			<div class="contact-buttons">
				<button class="btn btn-secondary" onclick="closeContactModal()">å…³é—­</button>
				<button class="btn btn-primary" onclick="copyQQFromModal()">å¤åˆ¶QQå·</button>
			</div>
		</div>
	</div>

	<!-- é€šç”¨é“¾æ¥å¼¹çª—æ¨¡æ¿ - æ™®é€šé“¾æ¥ -->
	<div id="linkModal" class="modal-overlay" onclick="closeGenericModal('linkModal', event)">
		<div class="link-modal" onclick="event.stopPropagation()">
			<div class="link-modal-header">
				<div class="link-modal-title" id="linkTitle">é“¾æ¥</div>
				<button class="link-modal-close" onclick="closeGenericModal('linkModal')">Ã—</button>
			</div>
			<div class="link-content">
				<div id="linkUrl" class="link-url"></div>
				<button class="btn btn-primary" onclick="copyGenericLinkFromModal('linkModal')">å¤åˆ¶é“¾æ¥</button>
			</div>
			<div class="modal-buttons">
				<button class="btn btn-secondary" onclick="closeGenericModal('linkModal')">å…³é—­</button>
				<button class="btn btn-primary" onclick="openGenericLinkFromModal('linkModal')">æ‰“å¼€é“¾æ¥</button>
			</div>
		</div>
	</div>

	<!-- é€šç”¨é“¾æ¥å¼¹çª—æ¨¡æ¿ - link1ä¸“ç”¨ -->
	<div id="link1Modal" class="modal-overlay" onclick="closeGenericModal('link1Modal', event)">
		<div class="link-modal" onclick="event.stopPropagation()">
			<div class="link-modal-header">
				<div class="link-modal-title" id="link1Title">é“¾æ¥1</div>
				<button class="link-modal-close" onclick="closeGenericModal('link1Modal')">Ã—</button>
			</div>
			<div class="link-content">
				<div id="link1Url" class="link-url"></div>
				<button class="btn btn-primary" onclick="copyGenericLinkFromModal('link1Modal')">å¤åˆ¶é“¾æ¥</button>
			</div>
			<div class="modal-buttons">
				<button class="btn btn-secondary" onclick="closeGenericModal('link1Modal')">å…³é—­</button>
				<button class="btn btn-primary" onclick="openGenericLinkFromModal('link1Modal')">æ‰“å¼€é“¾æ¥</button>
			</div>
		</div>
	</div>

	<!-- å¾®ä¿¡é£æ ¼é€šçŸ¥å¼¹çª— -->
	<div id="wechatNotification" class="wechat-notification" onclick="hideWeChatNotification()">
		<div class="notification-header">
			<div class="notification-icon">ğŸ’¬</div>
			<div class="studio-name">MZå·¥ä½œå®¤</div>
		</div>
		<div class="notification-content">
			<div style="font-weight: bold; margin-bottom: 3px;">æ¤åˆ›é­”ç›’</div>
			<div data-zh="æˆ‘ä»¬åªæ˜¯PVZçš„å¿ å®çˆ±å¥½è€…ï¼" data-en="We are just loyal fans of PVZ!">æˆ‘ä»¬åªæ˜¯PVZçš„å¿ å®çˆ±å¥½è€…ï¼</div>
		</div>
	</div>

	<!-- å¤åˆ¶æˆåŠŸæç¤ºå¼¹çª— -->
	<div id="copySuccessModal" class="copy-success-modal">å·²å¤åˆ¶åˆ°å‰ªè´´æ¿</div>

	<!-- éœ¸ç‹æ¡æ¬¾å¼¹çª— -->
	<div id="termsOverlay" class="terms-overlay" onclick="closeTermsModal(event)">
		<div class="terms-modal" onclick="event.stopPropagation()">
			<div class="terms-header">
				<h2 class="terms-title" data-zh="æ¤åˆ›é­”ç›’éœ¸ç‹æ¡æ¬¾" data-en="PVZ Magic Box Terms">æ¤åˆ›é­”ç›’éœ¸ç‹æ¡æ¬¾</h2>
				<button class="terms-close" onclick="closeTermsModal()">Ã—</button>
			</div>
			<div class="terms-content" id="termsContent">
				<div class="loading-text">æ­£åœ¨åŠ è½½æ¡æ¬¾å†…å®¹...</div>
			</div>
		</div>
	</div>

	<!-- åº•éƒ¨å¯¼èˆªæ  - åŠ¨æ€ç”Ÿæˆ -->
	<div class="bottom-nav" id="bottomNav">
		<!-- å¯¼èˆªé¡¹å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
	</div>

	<!-- å…³äºæˆ‘ä»¬é¡µé¢ -->
	<div id="aboutPage" class="about-page">
		<!-- å¤´éƒ¨ -->
		<div class="about-header">
			<button class="back-btn" onclick="hideAbout()">â†</button>
			<div class="header-title" data-zh="å…³äºæˆ‘ä»¬" data-en="About Us">å…³äºæˆ‘ä»¬</div>
		</div>

		<!-- åº”ç”¨ä¿¡æ¯ -->
		<div class="app-info">
			<div class="app-icon">
				<img src="å›¾æ ‡.jpg" alt="åº”ç”¨å›¾æ ‡" onerror="this.style.display='none'; this.parentNode.innerHTML='ğŸ“±'; this.parentNode.style.fontSize='36px'; this.parentNode.style.display='flex'; this.parentNode.style.alignItems='center'; this.parentNode.style.justifyContent='center'">
			</div>
			<div class="app-name" data-zh="è½¯ä»¶æœç´¢ä¸‹è½½" data-en="Software Search Download">è½¯ä»¶æœç´¢ä¸‹è½½</div>
			<div class="version-display" id="versionDisplay">ç‰ˆæœ¬ 1.2</div>
		</div>
	</div>

	<!-- è®¾ç½®é¡µé¢ - ä¿®æ”¹åçš„ç®€æ´ç‰ˆæœ¬ -->
	<div id="settingsPage" class="settings-page">
		<!-- å¤´éƒ¨ -->
		<div class="settings-header">
			<button class="back-btn" onclick="hideSettings()">â†</button>
			<div class="header-title" style="font-size: 18px; font-weight: bold; flex: 1; text-align: center;" data-zh="è®¾ç½®" data-en="Settings">è®¾ç½®</div>
			<div style="width: 40px;"></div> <!-- å ä½å…ƒç´ ï¼Œå¹³è¡¡è¿”å›æŒ‰é’®çš„ç©ºé—´ -->
		</div>

		<!-- é¡¶éƒ¨å›¾æ ‡ - è°ƒç”¨å›¾æ ‡.jpg -->
		<div class="settings-icon-container">
			<img src="å›¾æ ‡.jpg" alt="åº”ç”¨å›¾æ ‡" class="settings-icon" onerror="this.style.display='none'; this.parentNode.innerHTML='âš™ï¸'; this.parentNode.style.fontSize='36px'; this.parentNode.style.display='flex'; this.parentNode.style.alignItems='center'; this.parentNode.style.justifyContent='center';">
		</div>

		<!-- è®¾ç½®å†…å®¹ -->
		<div class="settings-content">
			<div class="setting-item">
				<span class="setting-label" data-zh="åº”ç”¨ç‰ˆæœ¬" data-en="App Version">åº”ç”¨ç‰ˆæœ¬</span>
				<span class="setting-value" id="settingsVersionDisplay">1.2</span>
			</div>
			<div class="setting-item">
				<span class="setting-label" data-zh="å¼€å‘è€…" data-en="Developer">å¼€å‘è€…</span>
				<span class="setting-value">MZå·¥ä½œå®¤</span>
			</div>
			<div class="setting-item">
				<span class="setting-label" data-zh="è”ç³»æ–¹å¼" data-en="Contact Info">è”ç³»æ–¹å¼</span>
				<span class="setting-value">QQ: 2019947085</span>
			</div>
			<div class="setting-item">
				<span class="setting-label" data-zh="ä¸»é¢˜æ¨¡å¼" data-en="Theme Mode">ä¸»é¢˜æ¨¡å¼</span>
				<span class="setting-value" data-zh="æµ…è‰²æ¨¡å¼" data-en="Light Mode">æµ…è‰²æ¨¡å¼</span>
			</div>
			<div class="setting-item">
				<span class="setting-label" data-zh="è‹±è¯­æ¨¡å¼" data-en="Translation in English mode">å¤šè¯­è¨€æ”¯æŒ</span>
				<span class="setting-value">
					<label class="language-switch">
						<input type="checkbox" id="languageToggle" onchange="toggleLanguage()">
						<span class="slider"></span>
					</label>
				</span>
			</div>
			<!-- æ–°å¢ï¼šå¯ç”¨åœ¨çº¿åº”ç”¨æ•°æ®å¼€å…³ -->
			<div class="setting-item">
				<span class="setting-label" data-zh="å¯ç”¨åœ¨çº¿æ•°æ®ï¼ˆæœ€æ–°ï¼‰" data-en="Enable Online App Data">å¯ç”¨åœ¨çº¿åº”ç”¨æ•°æ®</span>
				<span class="setting-value">
					<label class="language-switch">
						<input type="checkbox" id="onlineDataToggle" onchange="toggleOnlineData()">
						<span class="slider"></span>
					</label>
					<span class="beta-tag">beta</span>
				</span>
			</div>
		</div>

		<!-- æ–°å¢ï¼šæ¤åˆ›é­”ç›’éœ¸ç‹æ¡æ¬¾é˜…è¯» -->
		<div class="function-list" style="margin-top: 30px;">
			<div class="list-item" onclick="showTermsModal()">
				<div class="list-item-left">
					<div class="list-icon">ğŸ“‹</div>
					<div class="list-text" data-zh="æ¤åˆ›é­”ç›’éœ¸ç‹æ¡æ¬¾" data-en="PVZ Magic Box Terms">æ¤åˆ›é­”ç›’éœ¸ç‹æ¡æ¬¾</div>
				</div>
				<button class="view-btn" onclick="event.stopPropagation(); showTermsModal()">é˜…è¯»</button>
			</div>
		</div>
	</div>

	<script>
		/*********************** å¯é…ç½®çš„åº•éƒ¨å¯¼èˆª *************************/
		const NAV_CONFIG = [
		  { 
			icon: 'home.png', 
			text: { zh: 'ä¸»é¡µ', en: 'Home' }, 
			link: 'indexhome.html', 
			active: true 
		  },
		  { 
			icon: 'author.png', 
			text: { zh: 'è®ºå›', en: 'forum ' }, 
			link: 'index2.html' 
		  },
		  { 
			icon: 'my.png', 
			text: { zh: 'æˆ‘çš„', en: 'Profile' }, 
			link: 'index3.html' 
		  }
		];

		/*********************** å¯é…ç½®çš„åŠŸèƒ½åˆ—è¡¨ *************************/
		const FUNCTION_LIST_CONFIG = [
			{
				id: 'contact',
				icon: 'ğŸ“',
				text: { zh: 'è”ç³»ä½œè€…', en: 'Contact Author' },
				actionType: 'modal', // modal:å¼¹çª— | link:é“¾æ¥ | page:é¡µé¢ | function:è‡ªå®šä¹‰å‡½æ•°
				actionTarget: 'contactModal', // å¯¹åº”å¼¹çª—ID/é“¾æ¥åœ°å€/é¡µé¢ID/å‡½æ•°å
				btnText: { zh: 'æŸ¥çœ‹', en: 'View' }
			},
			{
				id: 'settings',
				icon: 'âš™ï¸',
				text: { zh: 'è®¾ç½®', en: 'Settings' },
				actionType: 'function',
				actionTarget: 'goToSettings',
				btnText: { zh: '', en: '' }, // ç©ºåˆ™ä¸æ˜¾ç¤ºæŒ‰é’®
				showBtn: false // æ§åˆ¶æ˜¯å¦æ˜¾ç¤ºæŒ‰é’®
			},
			{
				id: 'about',
				icon: 'â„¹ï¸',
				text: { zh: 'å…³äºæˆ‘ä»¬', en: 'About Us' },
				actionType: 'function',
				actionTarget: 'showAboutNotification',
				btnText: { zh: '', en: '' },
				showBtn: false
			},
			// ç¤ºä¾‹ï¼šæ–°å¢é“¾æ¥ç±»å‹é¡¹ - ä½¿ç”¨é€šç”¨å¼¹çª—ç³»ç»Ÿ
			{
				id: 'official-site',
				icon: 'â¤ï¸â€ğŸ”¥',
				text: { zh: 'æ”¯æŒä½œè€…ï¼ˆçˆ±å‘ç”µï¼‰', en: 'Official Site' },
				actionType: 'link',
				actionTarget: 'linkModal', // å¼¹çª—ID
				linkUrl: 'https://afdian.com/a/DLHC1145', // å®é™…é“¾æ¥åœ°å€
				btnText: { zh: 'è®¿é—®', en: 'Visit' }
			},
			{
				id: 'official-site-smr',
				icon: 'ğŸ”§',
				text: { zh: 'ç¥ç§˜äººå·¥å…·ç®±&ç¥ç§˜äººä¸»é¡µ', en: 'MysteryBox & MysteryHome' },
				actionType: 'link',
				actionTarget: 'link1Modal', // å¼¹çª—ID
				linkUrl: 'https://b23.tv/MNqU5D2', // å®é™…é“¾æ¥åœ°å€
				btnText: { zh: 'æŸ¥çœ‹', en: 'Visit' }
			}
		];

		// å…¨å±€çŠ¶æ€ï¼šåœ¨çº¿æ•°æ®å¼€å…³
		let isOnlineDataEnabled = false;
		// å­˜å‚¨åŸå§‹å‡½æ•°å’Œä¿®æ”¹åçš„å‡½æ•°
		let originalFunctions = {};

		/*********************** é€šç”¨å¼¹çª—ç®¡ç†å‡½æ•° *************************/
		// é€šç”¨æ˜¾ç¤ºå¼¹çª—å‡½æ•°
		function showGenericModal(modalId, title, url) {
			const modal = document.getElementById(modalId);
			const baseId = modalId.replace('Modal', '');
			const titleElement = document.getElementById(baseId + 'Title');
			const urlElement = document.getElementById(baseId + 'Url');
			
			if (titleElement) titleElement.textContent = title;
			if (urlElement) {
				urlElement.innerHTML = `<a href="${url}" target="_blank">${url}</a>`;
				urlElement.setAttribute('data-link', url);
			}
			modal.classList.add('show');
		}

		// é€šç”¨å…³é—­å¼¹çª—å‡½æ•°
		function closeGenericModal(modalId, event) {
			if (event && event.target !== document.getElementById(modalId)) return;
			document.getElementById(modalId).classList.remove('show');
		}

		// é€šç”¨å¤åˆ¶é“¾æ¥å‡½æ•°
		function copyGenericLinkFromModal(modalId) {
			const baseId = modalId.replace('Modal', '');
			const urlElement = document.getElementById(baseId + 'Url');
			const url = urlElement.getAttribute('data-link');
			
			const textArea = document.createElement("textarea");
			textArea.value = url;
			textArea.style.top = "0";
			textArea.style.left = "0";
			textArea.style.position = "fixed";
			textArea.style.opacity = "0";
			
			document.body.appendChild(textArea);
			textArea.focus();
			textArea.select();
			
			try {
				const successful = document.execCommand('copy');
				if (successful) {
					showCopySuccess();
				} else {
					alert(isEnglishMode ? 'Copy failed, please manually copy the link' : 'å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶é“¾æ¥');
				}
			} catch (err) {
				console.error('å¤åˆ¶å¤±è´¥: ', err);
				alert(isEnglishMode ? 'Copy failed, please manually copy the link' : 'å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶é“¾æ¥');
			}
			
			document.body.removeChild(textArea);
		}

		// é€šç”¨æ‰“å¼€é“¾æ¥å‡½æ•°
		function openGenericLinkFromModal(modalId) {
			const baseId = modalId.replace('Modal', '');
			const urlElement = document.getElementById(baseId + 'Url');
			const url = urlElement.getAttribute('data-link');
			window.open(url, '_blank');
		}

		/*********************** å¤šè¯­è¨€ç›¸å…³ *************************/
		let isEnglishMode = false;
		
		function saveLanguageState(isEnglish) {
			localStorage.setItem('isEnglish', isEnglish.toString());
		}

		function getLanguageState() {
			return localStorage.getItem('isEnglish') === 'true';
		}

		function getNavLinkPath(configItem) {
			if (isEnglishMode) {
				return configItem.link;
			}
			return configItem.link;
		}

		// ç”Ÿæˆåº•éƒ¨å¯¼èˆªHTML - ä¿®æ”¹å›¾ç‰‡è·¯å¾„ä¸ºåŒç›®å½•
		function generateBottomNav() {
			const bottomNav = document.getElementById('bottomNav');
			let navHTML = '';
			
			NAV_CONFIG.forEach((item, index) => {
				const isActive = item.active ? 'active' : '';
				const text = isEnglishMode ? item.text.en : item.text.zh;
				const link = getNavLinkPath(item);
				
				navHTML += `
					<a href="${link}" class="nav-item ${isActive}" onclick="handleNavigation(${index}, event)">
						<div class="nav-icon">
							<img src="${item.icon}" alt="${text}" onerror="this.style.display='none'; this.parentNode.innerHTML='ğŸ“'; this.parentNode.style.fontSize='20px'; this.parentNode.style.display='flex'; this.parentNode.style.alignItems='center'; this.parentNode.style.justifyContent='center';">
						</div>
						<div class="nav-text">${text}</div>
					</a>
				`;
			});
			
			bottomNav.innerHTML = navHTML;
		}

		// ç”ŸæˆåŠŸèƒ½åˆ—è¡¨HTMLï¼ˆé…ç½®åŒ–ï¼‰
		function generateFunctionList() {
			const container = document.getElementById('functionListContainer');
			let listHTML = '';
			
			FUNCTION_LIST_CONFIG.forEach(item => {
				const text = isEnglishMode ? item.text.en : item.text.zh;
				const btnText = isEnglishMode ? item.btnText.en : item.btnText.zh;
				const showBtn = item.showBtn !== false; // é»˜è®¤æ˜¾ç¤ºæŒ‰é’®
				
				listHTML += `
					<div class="list-item" onclick="handleFunctionAction('${item.id}')">
						<div class="list-item-left">
							<div class="list-icon">${item.icon}</div>
							<div class="list-text">${text}</div>
						</div>
						${showBtn ? `<button class="view-btn" onclick="event.stopPropagation(); handleFunctionAction('${item.id}')">${btnText}</button>` : ''}
					</div>
				`;
			});
			
			container.innerHTML = listHTML;
		}

		// å¤„ç†åŠŸèƒ½åˆ—è¡¨ç‚¹å‡»äº‹ä»¶ï¼ˆé…ç½®åŒ–ï¼‰
		function handleFunctionAction(itemId) {
			const item = FUNCTION_LIST_CONFIG.find(item => item.id === itemId);
			if (!item) return;

			switch (item.actionType) {
				case 'modal':
					// æ˜¾ç¤ºæŒ‡å®šå¼¹çª—
					document.getElementById(item.actionTarget).classList.add('show');
					break;
				case 'link':
					// æ˜¾ç¤ºé“¾æ¥å¼¹çª— - ä½¿ç”¨é€šç”¨å‡½æ•°
					showGenericModal(item.actionTarget, isEnglishMode ? item.text.en : item.text.zh, item.linkUrl);
					break;
				case 'page':
					// æ˜¾ç¤ºæŒ‡å®šé¡µé¢
					document.getElementById(item.actionTarget).style.display = 'block';
					break;
				case 'function':
					// æ‰§è¡Œè‡ªå®šä¹‰å‡½æ•°
					if (typeof window[item.actionTarget] === 'function') {
						window[item.actionTarget]();
					}
					break;
			}
		}

		function handleNavigation(index, event) {
			if (event) {
				event.preventDefault();
			}

			const configItem = NAV_CONFIG[index];
			const targetPage = getNavLinkPath(configItem);
			const currentLang = isEnglishMode ? 'en' : 'zh';
			const pageNames = {
				0: { zh: 'ä¸»é¡µ', en: 'Home Page' },
				1: { zh: 'ä½œè€…é¡µ', en: 'forum  Page' },
				2: { zh: 'ä¸ªäººä¸­å¿ƒ', en: 'Profile Page' }
			};

			console.log(`ğŸš€ å¯¼èˆªåˆ°: ${targetPage}`);
			window.location.href = targetPage;
			updateNavigationState(index);
		}

		function updateNavigationState(activeIndex) {
			const navItems = document.querySelectorAll('.bottom-nav .nav-item');
			navItems.forEach((item, index) => {
				if (index === activeIndex) {
					item.classList.add('active');
				} else {
					item.classList.remove('active');
				}
			});
		}
/*********************** åœ¨çº¿æ•°æ®å¼€å…³ç›¸å…³ *************************/
let videoCheckPromise = null;
let lastVideoCheckTime = 0;
const VIDEO_CHECK_CACHE_TIME = 30000; // 30ç§’å†…ä½¿ç”¨ç¼“å­˜ç»“æœ

function checkStartupVideoExists() {
	// å¦‚æœå·²ç»æœ‰æ­£åœ¨è¿›è¡Œçš„æ£€æŸ¥ï¼Œè¿”å›è¯¥Promise
	if (videoCheckPromise) {
		return videoCheckPromise;
	}
	
	// æ£€æŸ¥ç¼“å­˜ï¼ˆé¿å…é¢‘ç¹æ£€æŸ¥ï¼‰
	const now = Date.now();
	if (now - lastVideoCheckTime < VIDEO_CHECK_CACHE_TIME) {
		console.log('ä½¿ç”¨ç¼“å­˜çš„è§†é¢‘æ£€æŸ¥ç»“æœ');
		return Promise.resolve(false); // ä¿å®ˆç­–ç•¥ï¼šç¼“å­˜æœŸå†…è®¤ä¸ºä¸å­˜åœ¨
	}
	
	videoCheckPromise = new Promise((resolve) => {
		const checkMethods = [
			// æ–¹æ³•1: HEADè¯·æ±‚ï¼ˆé¦–é€‰ï¼‰
			() => {
				return new Promise((res) => {
					const xhr = new XMLHttpRequest();
					xhr.open('HEAD', './è¿›å…¥è§†é¢‘.mp4', true);
					xhr.onreadystatechange = function() {
						if (xhr.readyState === 4) {
							const exists = xhr.status >= 200 && xhr.status < 400;
							console.log('HEADæ–¹æ³•æ£€æŸ¥ç»“æœ:', exists ? 'å­˜åœ¨' : 'ä¸å­˜åœ¨', 'çŠ¶æ€ç :', xhr.status);
							res({exists, method: 'HEAD', status: xhr.status});
						}
					};
					xhr.onerror = () => res({exists: false, method: 'HEAD', error: 'network'});
					xhr.ontimeout = () => res({exists: false, method: 'HEAD', error: 'timeout'});
					xhr.timeout = 3000;
					xhr.send();
				});
			},
			// æ–¹æ³•2: GETè¯·æ±‚ï¼ˆå¤‡é€‰ï¼‰
			() => {
				return new Promise((res) => {
					const xhr = new XMLHttpRequest();
					xhr.open('GET', './è¿›å…¥è§†é¢‘.mp4', true);
					xhr.responseType = 'blob';
					xhr.onreadystatechange = function() {
						if (xhr.readyState === 4) {
							const exists = xhr.status >= 200 && xhr.status < 400;
							console.log('GETæ–¹æ³•æ£€æŸ¥ç»“æœ:', exists ? 'å­˜åœ¨' : 'ä¸å­˜åœ¨', 'çŠ¶æ€ç :', xhr.status);
							// åŠæ—¶ç»ˆæ­¢å“åº”è¯»å–ä»¥èŠ‚çœå¸¦å®½
							if (exists) {
								xhr.abort();
							}
							res({exists, method: 'GET', status: xhr.status});
						}
					};
					xhr.onerror = () => res({exists: false, method: 'GET', error: 'network'});
					xhr.ontimeout = () => res({exists: false, method: 'GET', error: 'timeout'});
					xhr.timeout = 3000;
					xhr.send();
				});
			},
			// æ–¹æ³•3: å°è¯•ä¸åŒè·¯å¾„
			() => {
				return new Promise((res) => {
					const paths = [
						'./è¿›å…¥è§†é¢‘.mp4',
						'/è¿›å…¥è§†é¢‘.mp4',
						'è¿›å…¥è§†é¢‘.mp4',
						'./videos/è¿›å…¥è§†é¢‘.mp4'
					];
					
					let checked = 0;
					let found = false;
					
					paths.forEach(path => {
						if (found) return;
						
						const xhr = new XMLHttpRequest();
						xhr.open('HEAD', path, true);
						xhr.onreadystatechange = function() {
							if (xhr.readyState === 4 && !found) {
								if (xhr.status >= 200 && xhr.status < 400) {
									found = true;
									console.log(`è·¯å¾„ ${path} æ‰¾åˆ°è§†é¢‘æ–‡ä»¶`);
									res({exists, method: 'PATH_TRY', path: path});
								}
							}
						};
						xhr.onerror = () => {};
						xhr.timeout = 1000;
						xhr.send();
						
						checked++;
						if (checked === paths.length && !found) {
							res({exists: false, method: 'PATH_TRY', error: 'all_paths_failed'});
						}
					});
				});
			}
		];
		
		// ä¾æ¬¡å°è¯•å„ç§æ–¹æ³•
		const tryNextMethod = (index) => {
			if (index >= checkMethods.length) {
				console.error('æ‰€æœ‰æ£€æŸ¥æ–¹æ³•éƒ½å¤±è´¥äº†');
				resolve(false);
				videoCheckPromise = null;
				lastVideoCheckTime = now;
				return;
			}
			
			checkMethods[index]().then(result => {
				if (result.exists) {
					resolve(true);
				} else {
					console.log(`${result.method} æ–¹æ³•å¤±è´¥:`, result.error || `çŠ¶æ€ç  ${result.status}`);
					tryNextMethod(index + 1);
				}
			}).catch(() => {
				tryNextMethod(index + 1);
			});
		};
		
		tryNextMethod(0);
	});
	
	return videoCheckPromise;
}

// æ·»åŠ è°ƒè¯•å‡½æ•°
window.debugVideoCheck = async function() {
	console.log('=== å¼€å§‹è°ƒè¯•è§†é¢‘æ£€æŸ¥ ===');
	const exists = await checkStartupVideoExists();
	console.log('æœ€ç»ˆç»“æœ:', exists ? 'å­˜åœ¨' : 'ä¸å­˜åœ¨');
	console.log('========================');
	return exists;
};

async function toggleOnlineData() {
	console.log('å¼€å§‹åˆ‡æ¢åœ¨çº¿æ•°æ®æ¨¡å¼...');
	
	// æ£€æŸ¥è¿›å…¥è§†é¢‘æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼ˆå¼‚æ­¥ï¼‰
	const videoExists = await checkStartupVideoExists();
	
	console.log('è§†é¢‘æ£€æŸ¥ç»“æœ:', videoExists);
	
	if (!videoExists) {
		console.warn('ç½‘é¡µç«¯æ— æ³•ä½¿ç”¨æ­¤åŠŸèƒ½ï¼');
		alert(isEnglishMode ? 'Online feature requires startup video file to be present.' : 'åœ¨çº¿åŠŸèƒ½éœ€è¦å¯åŠ¨è§†é¢‘æ–‡ä»¶å­˜åœ¨æ‰èƒ½ä½¿ç”¨ã€‚');
		// ç¡®ä¿å¼€å…³å…³é—­çŠ¶æ€
		const toggle = document.getElementById('onlineDataToggle');
		if (toggle) {
			toggle.checked = false;
		}
		isOnlineDataEnabled = false;
		localStorage.setItem('isOnlineDataEnabled', 'false');
		return;
	}

	isOnlineDataEnabled = document.getElementById('onlineDataToggle').checked;
	localStorage.setItem('isOnlineDataEnabled', isOnlineDataEnabled.toString());
	
	console.log('åœ¨çº¿æ•°æ®æ¨¡å¼:', isOnlineDataEnabled ? 'å¯ç”¨' : 'ç¦ç”¨');
	
	// ä¿å­˜åŸå§‹å‡½æ•°ï¼ˆé¦–æ¬¡ä¿®æ”¹æ—¶ï¼‰
	if (isOnlineDataEnabled && !originalFunctions.handleFunctionAction) {
		originalFunctions.handleFunctionAction = handleFunctionAction;
		originalFunctions.generateFunctionList = generateFunctionList;
		
		// ä¿®æ”¹å‡½æ•°ä¸ºåœ¨çº¿ç‰ˆæœ¬
		window.handleFunctionAction = onlineHandleFunctionAction;
		window.generateFunctionList = onlineGenerateFunctionList;
		
		alert(isEnglishMode ? 'Online app data enabled! Functions updated.' : 'å·²å¯ç”¨åœ¨çº¿åº”ç”¨æ•°æ®ï¼åŠŸèƒ½å·²æ›´æ–°ã€‚');
	} else if (!isOnlineDataEnabled && originalFunctions.handleFunctionAction) {
		// æ¢å¤åŸå§‹å‡½æ•°
		window.handleFunctionAction = originalFunctions.handleFunctionAction;
		window.generateFunctionList = originalFunctions.generateFunctionList;
		
		alert(isEnglishMode ? 'Online app data disabled! Functions restored.' : 'å·²ç¦ç”¨åœ¨çº¿æ•°æ®åŠŸèƒ½ï¼åŠŸèƒ½å·²æ¢å¤ã€‚');
	}
	
	// é‡æ–°ç”ŸæˆåŠŸèƒ½åˆ—è¡¨
	generateFunctionList();
}


		/*********************** å¤šè¯­è¨€ç›¸å…³ *************************/
		function toggleLanguage() {
			const checkbox = document.getElementById('languageToggle');
			isEnglishMode = checkbox.checked;
			
			if (isEnglishMode) {
				translateToEnglish();
				saveLanguageState(true);
				setTimeout(() => {
					generateBottomNav();
					generateFunctionList();
				}, 500);
			} else {
				translateToChinese();
				saveLanguageState(false);
				generateBottomNav();
				generateFunctionList();
			}
		}

		function translateToEnglish() {
			const elements = document.querySelectorAll('[data-zh][data-en]');
			elements.forEach(element => {
				element.textContent = element.getAttribute('data-en');
			});

			const inputs = document.querySelectorAll('[data-placeholder-zh][data-placeholder-en]');
			inputs.forEach(input => {
				input.placeholder = input.getAttribute('data-placeholder-en');
			});

			document.title = 'Software Search Download';
			updateErrorMessage('usernameError', 'Username needs at least 2 characters');
			updateErrorMessage('passwordError', 'Password must be 8-12 characters and include both letters and numbers');
		}

		function translateToChinese() {
			const elements = document.querySelectorAll('[data-zh][data-en]');
			elements.forEach(element => {
				element.textContent = element.getAttribute('data-zh');
			});

			const inputs = document.querySelectorAll('[data-placeholder-zh][data-placeholder-en]');
			inputs.forEach(input => {
				input.placeholder = input.getAttribute('data-placeholder-zh');
			});

			document.title = 'è½¯ä»¶æœç´¢ä¸‹è½½';
			updateErrorMessage('usernameError', 'è´¦å·è‡³å°‘éœ€è¦2ä½å­—ç¬¦');
			updateErrorMessage('passwordError', 'å¯†ç éœ€8-12ä½ï¼Œä¸”å¿…é¡»åŒ…å«è‹±æ–‡å’Œæ•°å­—');
		}

		function updateErrorMessage(elementId, message) {
			const errorElement = document.getElementById(elementId);
			errorElement.textContent = message;
		}

		function checkLanguageState() {
			const savedIsEnglish = getLanguageState();
			const checkbox = document.getElementById('languageToggle');
			checkbox.checked = savedIsEnglish;
			isEnglishMode = savedIsEnglish;
			
			if (savedIsEnglish) {
				translateToEnglish();
			} else {
				translateToChinese();
			}
			
			generateBottomNav();
			generateFunctionList();
		}

		/*********************** ç™»å½•ç›¸å…³ *************************/
		function saveLoginState(username) {
			localStorage.setItem('username', username);
			localStorage.setItem('isLoggedIn', 'true');
			localStorage.setItem('loginTime', new Date().getTime());
		}

		function getLoginState() {
			const isLoggedIn = localStorage.getItem('isLoggedIn') === 'true';
			const username = localStorage.getItem('username');
			const loginTime = localStorage.getItem('loginTime');
			
			if (isLoggedIn && loginTime) {
				const now = new Date().getTime();
				const oneYear = 365 * 24 * 60 * 60 * 1000;
				if (now - parseInt(loginTime) > oneYear) {
					clearLoginState();
					return { isLoggedIn: false, username: null };
				}
			}
			
			return { isLoggedIn, username };
		}

		function clearLoginState() {
			localStorage.removeItem('username');
			localStorage.removeItem('isLoggedIn');
			localStorage.removeItem('loginTime');
		}

		function extractVersionFromHTML() {
			const titleMatch = document.title.match(/(\d+\.\d+)/);
			if (titleMatch) {
				return `ç‰ˆæœ¬ ${titleMatch[1]} å†…æµ‹ç‰ˆ`;
			}
			return 'ç‰ˆæœ¬ 1.2';
		}

		function validateUsername(username) {
			return username && username.length >= 2;
		}

		function validatePassword(password) {
			if (!password || password.length < 8 || password.length > 12) {
				return false;
			}
			const hasLetter = /[a-zA-Z]/.test(password);
			const hasNumber = /\d/.test(password);
			return hasLetter && hasNumber;
		}

		function showLoginModal() {
			document.getElementById('loginModal').classList.add('show');
			document.getElementById('username').focus();
		}

		function closeLoginModal(event) {
			if (event && event.target !== document.getElementById('loginModal')) return;
			document.getElementById('loginModal').classList.remove('show');
			clearErrors();
			document.getElementById('loginForm').reset();
		}

		function clearErrors() {
			document.getElementById('usernameError').style.display = 'none';
			document.getElementById('passwordError').style.display = 'none';
		}

		function showError(elementId, message) {
			const errorElement = document.getElementById(elementId);
			errorElement.textContent = message;
			errorElement.style.display = 'block';
		}

		function handleLogin(event) {
			event.preventDefault();
			
			const username = document.getElementById('username').value.trim();
			const password = document.getElementById('password').value;

			clearErrors();

			let isValid = true;

			if (!validateUsername(username)) {
				showError('usernameError', isEnglishMode ? 'Username needs at least 2 characters' : 'è´¦å·è‡³å°‘éœ€è¦2ä½å­—ç¬¦');
				isValid = false;
			}

			if (!validatePassword(password)) {
				showError('passwordError', isEnglishMode ? 'Password must be 8-12 characters and include both letters and numbers' : 'å¯†ç éœ€8-12ä½ï¼Œä¸”å¿…é¡»åŒ…å«è‹±æ–‡å’Œæ•°å­—');
				isValid = false;
			}

			if (!isValid) return;

			saveLoginState(username);
			updateUserInterface(username);
			closeLoginModal();
			alert(isEnglishMode ? 'Login successful! Welcome ' + username : 'ç™»å½•æˆåŠŸï¼æ¬¢è¿ ' + username);
		}

		function logout() {
			const confirmMsg = isEnglishMode ? 'Are you sure you want to log out?' : 'ç¡®å®šé€€å‡ºç™»å½•å—ï¼Ÿ';
			if (confirm(confirmMsg)) {
				clearLoginState();
				updateUserInterface(null);
				alert(isEnglishMode ? 'Logged out successfully' : 'å·²é€€å‡ºç™»å½•');
			}
		}

		function updateUserInterface(username) {
			const welcomeText = document.getElementById('welcomeText');
			const loginStatus = document.getElementById('loginStatus');
			const logoutBtn = document.getElementById('logoutBtn');

			if (username) {
				welcomeText.textContent = isEnglishMode ? `Welcome, ${username}` : `æ¬¢è¿æ‚¨ï¼Œ${username}`;
				loginStatus.textContent = isEnglishMode ? 'Logged in' : 'å·²ç™»å½•';
				loginStatus.onclick = null;
				logoutBtn.style.display = 'inline-block';
			} else {
				welcomeText.textContent = isEnglishMode ? 'Welcome to visit' : 'æ¬¢è¿è®¿é—®';
				loginStatus.textContent = isEnglishMode ? 'Click to login' : 'ç‚¹å‡»ç™»å½•';
				loginStatus.onclick = showLoginModal;
				logoutBtn.style.display = 'none';
			}
		}

		function checkLoginStatus() {
			const loginState = getLoginState();
			if (loginState.isLoggedIn && loginState.username) {
				updateUserInterface(loginState.username);
			}
		}

		/*********************** è”ç³»ä½œè€… & é“¾æ¥å¼¹çª—ç›¸å…³ *************************/
		function showContactModal() {
			document.getElementById('contactModal').classList.add('show');
		}

		function closeContactModal(event) {
			if (event && event.target !== document.getElementById('contactModal')) return;
			document.getElementById('contactModal').classList.remove('show');
		}

		function copyQQFromModal() {
			const qqNumber = '2019947085';
			
			const textArea = document.createElement("textarea");
			textArea.value = qqNumber;
			textArea.style.top = "0";
			textArea.style.left = "0";
			textArea.style.position = "fixed";
			textArea.style.opacity = "0";
			
			document.body.appendChild(textArea);
			textArea.focus();
			textArea.select();
			
			try {
				const successful = document.execCommand('copy');
				if (successful) {
					showCopySuccess();
					setTimeout(() => {
						closeContactModal({ target: document.getElementById('contactModal') });
					}, 1500);
				} else {
					alert(isEnglishMode ? 'Copy failed, please manually copy QQ number: ' + qqNumber : 'å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶QQå·ï¼š' + qqNumber);
				}
			} catch (err) {
				console.error('å¤åˆ¶å¤±è´¥: ', err);
				alert(isEnglishMode ? 'Copy failed, please manually copy QQ number: ' + qqNumber : 'å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶QQå·ï¼š' + qqNumber);
			}
			
			document.body.removeChild(textArea);
		}

		// ä¿ç•™åŸå‡½æ•°ç”¨äºå‘åå…¼å®¹ï¼Œä½†å®é™…ä½¿ç”¨é€šç”¨å‡½æ•°
		function showLinkModal(text, url) {
			showGenericModal('linkModal', isEnglishMode ? text.en : text.zh, url);
		}

		function closeLinkModal(event) {
			closeGenericModal('linkModal', event);
		}

		function copyLinkFromModal() {
			copyGenericLinkFromModal('linkModal');
		}

		function openLinkFromModal() {
			openGenericLinkFromModal('linkModal');
		}

		function showCopySuccess() {
			const modal = document.getElementById('copySuccessModal');
			modal.textContent = isEnglishMode ? 'Copied to clipboard' : 'å·²å¤åˆ¶åˆ°å‰ªè´´æ¿';
			modal.classList.add('show');
			setTimeout(() => {
				modal.classList.remove('show');
			}, 2000);
		}

		/*********************** é€šçŸ¥ & è®¾ç½®ç›¸å…³ *************************/
		function showWeChatNotification() {
			const notification = document.getElementById('wechatNotification');
			notification.classList.add('show');
		}

		function hideWeChatNotification() {
			const notification = document.getElementById('wechatNotification');
			notification.classList.remove('show');
		}

		let lastShowTime = 0;
		const COOLDOWN_TIME = 3000;

		function showAboutNotification() {
			const currentTime = new Date().getTime();
			
			if (currentTime - lastShowTime < COOLDOWN_TIME) {
				return;
			}
			
			showWeChatNotification();
			lastShowTime = currentTime;
			
			setTimeout(() => {
				hideWeChatNotification();
			}, 3000);
		}

		function goToSettings() {
			document.getElementById('functionListContainer').style.display = 'none';
			document.getElementById('settingsPage').style.display = 'block';
			
			const version = extractVersionFromHTML();
			document.getElementById('settingsVersionDisplay').textContent = version.replace('ç‰ˆæœ¬ ', '');
			
			// æ¢å¤åœ¨çº¿æ•°æ®å¼€å…³çŠ¶æ€
			const savedOnlineData = localStorage.getItem('isOnlineDataEnabled') === 'true';
			document.getElementById('onlineDataToggle').checked = savedOnlineData;
			isOnlineDataEnabled = savedOnlineData;
		}

		function hideSettings() {
			document.getElementById('settingsPage').style.display = 'none';
			document.getElementById('functionListContainer').style.display = 'block';
		}

		function hideAbout() {
			document.getElementById('aboutPage').style.display = 'none';
		}

		/*********************** éœ¸ç‹æ¡æ¬¾ç›¸å…³ *************************/
		function loadTermsContent() {
			const termsContent = document.getElementById('termsContent');
			
			const xhr = new XMLHttpRequest();
			xhr.open('GET', 'éœ¸ç‹æ¡æ¬¾.txt', true);
			xhr.onreadystatechange = function() {
				if (xhr.readyState === 4) {
					if (xhr.status === 200) {
						const content = xhr.responseText;
						termsContent.innerHTML = content.replace(/\n/g, '<br>');
					} else {
						termsContent.innerHTML = '<div class="error-text">' + (isEnglishMode ? 'Failed to read terms. Please ensure "éœ¸ç‹æ¡æ¬¾.txt" file exists in the same directory' : 'è¯»å–éœ¸ç‹æ¡æ¬¾å¤±è´¥ï¼Œè¯·ç¡®ä¿"éœ¸ç‹æ¡æ¬¾.txt"æ–‡ä»¶å­˜åœ¨äºåŒç›®å½•ä¸‹') + '</div>';
					}
				}
			};
			xhr.send();
		}

		function showTermsModal() {
			document.getElementById('termsContent').innerHTML = '<div class="loading-text">' + (isEnglishMode ? 'Loading terms...' : 'æ­£åœ¨åŠ è½½æ¡æ¬¾å†…å®¹...') + '</div>';
			document.getElementById('termsOverlay').classList.add('show');
			loadTermsContent();
		}

		function closeTermsModal(event) {
			if (!event || event.target === document.getElementById('termsOverlay') || event.target.classList.contains('terms-close')) {
				document.getElementById('termsOverlay').classList.remove('show');
			}
		}

		/*********************** åˆå§‹åŒ– *************************/
		document.getElementById('loginForm').addEventListener('submit', handleLogin);
		checkLoginStatus();
		checkLanguageState();

		// åˆå§‹åŒ–åœ¨çº¿æ•°æ®å¼€å…³çŠ¶æ€
		document.addEventListener('DOMContentLoaded', function() {
			console.log('ğŸ”§ å¯é…ç½®å¯¼èˆªç³»ç»Ÿå·²åˆå§‹åŒ–');
			console.log('ğŸ“ è¯·ç¡®ä¿å›¾ç‰‡æ–‡ä»¶ä½äºåŒç›®å½•ä¸‹:', NAV_CONFIG.map(item => item.icon).join(', '));
			
			// æ¢å¤åœ¨çº¿æ•°æ®å¼€å…³çŠ¶æ€
			const savedOnlineData = localStorage.getItem('isOnlineDataEnabled') === 'true';
			document.getElementById('onlineDataToggle').checked = savedOnlineData;
			isOnlineDataEnabled = savedOnlineData;
			
			// å¦‚æœå¯ç”¨äº†åœ¨çº¿æ•°æ®ï¼Œåˆå§‹åŒ–ä¿®æ”¹åçš„å‡½æ•°
			if (isOnlineDataEnabled) {
				originalFunctions.handleFunctionAction = handleFunctionAction;
				originalFunctions.generateFunctionList = generateFunctionList;
				window.handleFunctionAction = onlineHandleFunctionAction;
				window.generateFunctionList = onlineGenerateFunctionList;
				generateFunctionList();
			}
		});
	</script>
</body>
</html>