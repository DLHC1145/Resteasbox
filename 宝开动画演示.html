<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>APKå·¥å…·ç®±ï¼ˆç²¾ç®€å¯ç”¨ç‰ˆï¼‰</title>
  <style>
	body {
	  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
	  margin: 0;
	  padding: 20px;
	  background: #fff;
	  color: #333;
	  line-height: 1.6;
	}
	.container {
	  max-width: 800px;
	  margin: 0 auto;
	  background: #fff;
	  border: 1px solid #ddd;
	  border-radius: 8px;
	  padding: 20px;
	  box-shadow: 0 2px 6px rgba(0,0,0,0.1);
	}
	h1 { font-size: 1.5rem; margin: 0 0 10px; }
	.desc { color: #666; margin: 0 0 16px; font-size: 0.9rem; }
	.section {
	  margin-bottom: 24px;
	  border: 1px solid #ddd;
	  border-radius: 6px;
	  padding: 16px;
	}
	.section h2 {
	  font-size: 1.1rem;
	  margin: 0 0 12px;
	  font-weight: 600;
	}
	input[type="file"] {
	  margin-bottom: 10px;
	}
	button {
	  padding: 8px 12px;
	  background: #007bff;
	  color: white;
	  border: none;
	  border-radius: 4px;
	  cursor: pointer;
	  margin-right: 8px;
	  margin-bottom: 8px;
	}
	button:disabled {
	  background: #ccc;
	  cursor: not-allowed;
	}
	button.secondary {
	  background: #6c757d;
	}
	textarea {
	  width: 100%;
	  min-height: 80px;
	  padding: 8px;
	  border: 1px solid #ccc;
	  border-radius: 4px;
	  font-family: monospace;
	  font-size: 0.85rem;
	  resize: vertical;
	  background: #f9f9f9;
	}
	#status {
	  margin-top: 8px;
	  font-size: 0.85rem;
	  min-height: 1.3em;
	}
	.success { color: #28a745; }
	.error { color: #dc3545; }
	.info { color: #17a2b8; }
  </style>
</head>
<body>
  <div class="container">
	<h1>ğŸ”§ APKå·¥å…·ç®±ï¼ˆç²¾ç®€å¯ç”¨ç‰ˆï¼‰</h1>
	<p class="desc">çº¯å‰ç«¯å·¥å…·ï¼ŒåŠŸèƒ½åŒ…æ‹¬ï¼šä¸Šä¼ APKã€è§£æåŸºæœ¬ä¿¡æ¯ã€ç”Ÿæˆæ¸…ç¼“å­˜è„šæœ¬ã€åˆå¹¶ä¸¤ä¸ªAPKä¸ºZIPã€‚</p>

	<!-- 1. ç‚¹å‡»æŒ‰é’®ä¸Šä¼ æ–‡ä»¶ -->
	<div class="section">
	  <h2>1. ğŸ“ ä¸Šä¼ æ–‡ä»¶</h2>
	  <input type="file" id="fileInput" multiple />
	  <div id="fileInfo"></div>
	</div>

	<!-- 2. APKä¿¡æ¯è§£æ -->
	<div class="section">
	  <h2>2. ğŸ“„ APK ä¿¡æ¯è§£æ</h2>
	  <input type="file" id="apkFile" accept=".apk" />
	  <textarea id="apkInfo" readonly placeholder="ä¸Šä¼ APKåæ˜¾ç¤ºåŒ…åã€ç‰ˆæœ¬ç­‰ä¿¡æ¯..."></textarea>
	  <button id="copyApkInfo" disabled>å¤åˆ¶ä¿¡æ¯</button>
	  <div id="apkStatus" class="info"></div>
	</div>

	<!-- 3. ç”Ÿæˆæ¸…ç¼“å­˜è„šæœ¬ -->
	<div class="section">
	  <h2>3. ğŸ§¹ ç”Ÿæˆâ€œé¦–æ¬¡å¯åŠ¨æ¸…é™¤æŒ‡å®šè·¯å¾„â€è„šæœ¬</h2>
	  <div>
		<label>è·¯å¾„ï¼ˆå¦‚ /sdcard/Android/data/...ï¼‰ï¼š</label><br/>
		<input type="text" id="cleanPath" placeholder="/sdcard/Android/data/com.example.app/cache" style="width:100%;padding:8px;margin:4px 0;" />
	  </div>
	  <div>
		<label>è„šæœ¬ç±»å‹ï¼š</label><br/>
		<select id="scriptType" style="width:100%;padding:8px;margin:4px 0;">
		  <option value="shell">Android Shell</option>
		  <option value="bat">Windows æ‰¹å¤„ç†</option>
		</select>
	  </div>
	  <button id="genScript">ç”Ÿæˆè„šæœ¬</button>
	  <textarea id="scriptOutput" readonly placeholder="ç”Ÿæˆçš„è„šæœ¬å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ..."></textarea>
	  <button id="copyScript" disabled>å¤åˆ¶è„šæœ¬</button>
	  <div id="scriptStatus" class="info"></div>
	</div>

	<!-- 4. åˆå¹¶ä¸¤ä¸ªAPKä¸ºZIP -->
	<div class="section">
	  <h2>4. ğŸ“¦ åˆå¹¶ä¸¤ä¸ªAPKä¸ºä¸€ä¸ªZIPï¼ˆä¾¿äºåˆ†å‘ï¼‰</h2>
	  <div>
		<label>APK 1ï¼š</label><br/>
		<input type="file" id="apkFile1" accept=".apk" /><br/><br/>
		<label>APK 2ï¼š</label><br/>
		<input type="file" id="apkFile2" accept=".apk" />
	  </div>
	  <button id="mergeApks">æ‰“åŒ…ä¸ºZIP</button>
	  <div id="mergeStatus" class="info"></div>
	</div>
  </div>

  <script>
	// å·¥å…·å‡½æ•°
	const $ = id => document.getElementById(id);
	const readAsArrayBuffer = file => new Promise((resolve, reject) => {
	  const r = new FileReader();
	  r.onload = () => resolve(r.result);
	  r.onerror = reject;
	  r.readAsArrayBuffer(file);
	});
	const download = (blob, name) => {
	  const a = document.createElement('a');
	  a.href = URL.createObjectURL(blob);
	  a.download = name;
	  document.body.appendChild(a);
	  a.click();
	  document.body.removeChild(a);
	  URL.revokeObjectURL(a.href);
	};

	// 1. ç‚¹å‡»æŒ‰é’®ä¸Šä¼ æ–‡ä»¶ï¼ˆæ˜¾ç¤ºæ–‡ä»¶åå’Œå¤§å°ï¼‰
	$('fileInput').addEventListener('change', () => {
	  const files = $('fileInput').files;
	  let txt = files.length ? `å·²é€‰æ‹© ${files.length} ä¸ªæ–‡ä»¶ï¼š\n` : 'æœªé€‰æ‹©æ–‡ä»¶ã€‚';
	  for (let i = 0; i < files.length; i++) {
		const f = files[i];
		txt += `- ${f.name} (${(f.size / 1024).toFixed(2)} KB)\n`;
	  }
	  $('fileInfo').textContent = txt;
	});

	// 2. APK ä¿¡æ¯è§£æï¼ˆç›®å‰ä¸ºæ¨¡æ‹Ÿæ•°æ®ï¼‰
	$('apkFile').addEventListener('change', async () => {
	  const file = $('apkFile').files[0];
	  if (!file) {
		$('apkInfo').value = '';
		$('copyApkInfo').disabled = true;
		return;
	  }
	  try {
		// æ¨¡æ‹Ÿè§£æç»“æœï¼ˆå®é™…åº”è§£æ APK çš„çœŸå®å­—æ®µï¼‰
		const info = {
		  packageName: 'com.example.app',
		  versionName: '1.0.0',
		  versionCode: '1',
		  minSdk: '21',
		  targetSdk: '33'
		};
		$('apkInfo').value = [
		  `åŒ…åï¼š${info.packageName}`,
		  `ç‰ˆæœ¬åï¼š${info.versionName}`,
		  `ç‰ˆæœ¬å·ï¼š${info.versionCode}`,
		  `æœ€ä½SDKï¼š${info.minSdk}`,
		  `ç›®æ ‡SDKï¼š${info.targetSdk}`
		].join('\n');
		$('copyApkInfo').disabled = false;
		$('apkStatus').textContent = 'âœ… APK ä¿¡æ¯å·²è§£æï¼ˆæ¨¡æ‹Ÿæ•°æ®ï¼‰';
		$('apkStatus').className = 'success';
	  } catch (e) {
		$('apkInfo').value = 'âŒ è§£æå¤±è´¥ï¼š' + e.message;
		$('apkStatus').textContent = 'âŒ è§£æå¤±è´¥';
		$('apkStatus').className = 'error';
	  }
	});
	$('copyApkInfo').addEventListener('click', () => {
	  navigator.clipboard.writeText($('apkInfo').value).then(() => {
		const old = $('copyApkInfo').textContent;
		$('copyApkInfo').textContent = 'å·²å¤åˆ¶';
		setTimeout(() => $('copyApkInfo').textContent = old, 1500);
	  });
	});

	// 3. ç”Ÿæˆæ¸…ç¼“å­˜è„šæœ¬
	$('#genScript').addEventListener('click', () => {
	  const path = $('#cleanPath').value.trim();
	  const type = $('#scriptType').value;
	  if (!path) {
		$('#scriptStatus').textContent = 'âŒ è¯·è¾“å…¥è¦æ¸…é™¤çš„è·¯å¾„';
		$('#scriptStatus').className = 'error';
		return;
	  }
	  const script = type === 'shell' ?
		`#!/system/bin/sh\necho "æ¸…ç†è·¯å¾„: ${path}"\nrm -rf "${path}"/*\necho "å·²æ¸…ç†ã€‚"` :
		`@echo off\necho æ¸…ç†è·¯å¾„: ${path}\nrd /s /q "${path}"\necho å·²æ¸…ç†ã€‚`;
	  $('#scriptOutput').value = script;
	  $('#copyScript').disabled = false;
	  $('#scriptStatus').textContent = 'âœ… è„šæœ¬å·²ç”Ÿæˆ';
	  $('#scriptStatus').className = 'success';
	});
	$('#copyScript').addEventListener('click', () => {
	  navigator.clipboard.writeText($('#scriptOutput').value).then(() => {
		const old = $('#copyScript').textContent;
		$('#copyScript').textContent = 'å·²å¤åˆ¶';
		setTimeout(() => $('#copyScript').textContent = old, 1500);
	  });
	});

	// 4. åˆå¹¶ä¸¤ä¸ªAPKä¸ºZIP
	$('#mergeApks').addEventListener('click', async () => {
	  const f1 = $('#apkFile1').files[0];
	  const f2 = $('#apkFile2').files[0];
	  if (!f1 || !f2) {
		$('#mergeStatus').textContent = 'âŒ è¯·é€‰æ‹©ä¸¤ä¸ªAPKæ–‡ä»¶';
		$('#mergeStatus').className = 'error';
		return;
	  }
	  try {
		const b1 = await readAsArrayBuffer(f1);
		const b2 = await readAsArrayBuffer(f2);
		const combined = new Uint8Array(b1.byteLength + b2.byteLength);
		combined.set(new Uint8Array(b1), 0);
		combined.set(new Uint8Array(b2), b1.byteLength);
		const blob = new Blob([combined], { type: 'application/zip' });
		download(blob, 'merged_apks.zip');
		$('#mergeStatus').textContent = 'âœ… å·²ç”Ÿæˆ merged_apks.zipï¼ˆä¸¤ä¸ªAPKåˆå¹¶ä¸ºä¸€ä¸ªZIPï¼Œå¯ä¸‹è½½ï¼‰';
		$('#mergeStatus').className = 'success';
	  } catch (e) {
		$('#mergeStatus').textContent = 'âŒ åˆå¹¶å¤±è´¥ï¼š' + e.message;
		$('#mergeStatus').className = 'error';
	  }
	});
  </script>
</body>
</html>